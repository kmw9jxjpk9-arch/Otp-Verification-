<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AREX Airlines</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.tailwindcss.com"></script>

<!-- EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
emailjs.init("lKmMPVmP0ffKKZ1-");
</script>

<style>
.hidden { display:none; }
</style>
</head>

<body class="bg-gray-900 text-white min-h-screen flex justify-center items-center">

<div class="w-full max-w-md bg-gray-800 p-6 rounded-lg shadow-lg">

<!-- LOGIN -->
<div id="loginScreen">
<h2 class="text-2xl font-bold mb-4 text-center">AREX Login</h2>
<input id="loginEmail" class="w-full p-2 mb-3 rounded text-black" placeholder="Email">
<input id="loginPass" type="password" class="w-full p-2 mb-3 rounded text-black" placeholder="Password">
<button onclick="login()" class="bg-yellow-400 w-full py-2 rounded text-black font-bold">Login</button>
<p class="mt-3 text-center text-sm">No account? 
<span class="text-yellow-400 cursor-pointer" onclick="showSignup()">Sign up</span></p>
</div>

<!-- SIGNUP -->
<div id="signupScreen" class="hidden">
<h2 class="text-2xl font-bold mb-4 text-center">Create Account</h2>
<input id="signupName" class="w-full p-2 mb-3 rounded text-black" placeholder="Full Name">
<input id="signupEmail" class="w-full p-2 mb-3 rounded text-black" placeholder="Email">
<input id="signupPass" type="password" class="w-full p-2 mb-3 rounded text-black" placeholder="Password">
<button onclick="signup()" class="bg-yellow-400 w-full py-2 rounded text-black font-bold">Sign Up</button>
<p class="mt-3 text-center text-sm">
<span class="text-yellow-400 cursor-pointer" onclick="showLogin()">Back to login</span></p>
</div>

<!-- VERIFY -->
<div id="verifyScreen" class="hidden">
<h2 class="text-2xl font-bold mb-4 text-center">Verify Email</h2>
<p class="text-sm mb-3 text-center">Enter the 6-digit code sent to your email</p>
<input id="verifyCode" class="w-full p-2 mb-3 rounded text-black" placeholder="Verification Code">
<button onclick="verify()" class="bg-yellow-400 w-full py-2 rounded text-black font-bold">Verify</button>
</div>

<!-- APP -->
<div id="appScreen" class="hidden">
<h2 class="text-xl font-bold mb-4">✈ AREX Flight Search</h2>
<p class="mb-4">Welcome, <span id="userName"></span></p>

<div class="bg-gray-700 p-4 rounded mb-3">
<p>JFK → LHR</p>
<p class="text-yellow-400 font-bold">$450 — Non-stop</p>
</div>

<div class="bg-gray-700 p-4 rounded mb-3">
<p>JFK → LHR</p>
<p>$380 — 1 Stop</p>
</div>

<button onclick="logout()" class="bg-red-500 w-full py-2 rounded mt-4">Logout</button>
</div>

</div>

<script>
// Screen helpers
function showSignup(){ loginScreen.classList.add("hidden"); signupScreen.classList.remove("hidden"); }
function showLogin(){ signupScreen.classList.add("hidden"); loginScreen.classList.remove("hidden"); }
function showVerify(){ signupScreen.classList.add("hidden"); verifyScreen.classList.remove("hidden"); }
function showApp(){
 verifyScreen.classList.add("hidden");
 loginScreen.classList.add("hidden");
 appScreen.classList.remove("hidden");
}

// Email sender
function sendVerification(name,email,code){
 emailjs.send("service_co9t65h","template_te617ap",{name,email,code})
 .then(()=>console.log("Email sent"))
 .catch(()=>alert("Email sending failed"));
}

// Signup
function signup(){
 let name=signupName.value, email=signupEmail.value, pass=signupPass.value;
 let users=JSON.parse(localStorage.getItem("users")||"{}");

 if(users[email]) return alert("Email already exists");

 let code=Math.floor(100000+Math.random()*900000).toString();

 users[email]={name,pass,verified:false,code};
 localStorage.setItem("users",JSON.stringify(users));
 localStorage.setItem("verifyEmail",email);

 sendVerification(name,email,code);
 showVerify();
}

// Verify
function verify(){
 let email=localStorage.getItem("verifyEmail");
 let code=verifyCode.value;
 let users=JSON.parse(localStorage.getItem("users"));

 if(users[email].code===code){
  users[email].verified=true;
  delete users[email].code;
  localStorage.setItem("users",JSON.stringify(users));
  localStorage.setItem("session",email);
  userName.innerText=users[email].name;
  showApp();
 } else alert("Invalid code");
}

// Login
function login(){
 let email=loginEmail.value, pass=loginPass.value;
 let users=JSON.parse(localStorage.getItem("users")||"{}");

 if(!users[email]||users[email].pass!==pass) return alert("Invalid login");
 if(!users[email].verified) return alert("Please verify your email");

 localStorage.setItem("session",email);
 userName.innerText=users[email].name;
 showApp();
}

// Logout
function logout(){
 localStorage.removeItem("session");
 location.reload();
}

// Auto login
let session=localStorage.getItem("session");
if(session){
 let users=JSON.parse(localStorage.getItem("users"));
 userName.innerText=users[session].name;
 showApp();
}
</script>

</body>
</html>